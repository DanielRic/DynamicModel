(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80370,       2078]
NotebookOptionsPosition[     76752,       2017]
NotebookOutlinePosition[     77148,       2033]
CellTagsIndexPosition[     77105,       2030]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X", "[", "t_", "]"}], ":=", " ", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"t", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Y", "[", "t_", "]"}], ":=", " ", 
    RowBox[{"RotationMatrix", "[", 
     RowBox[{"t", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z", "[", "t_", "]"}], ":=", " ", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"t", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"skewToq", "[", "M_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"And", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "M", "]"}], "\[Equal]", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], ",", 
       RowBox[{"M", "\[Equal]", 
        RowBox[{"-", 
         RowBox[{"Transpose", "[", "M", "]"}]}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"skewMat", "[", "v_", "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"-", 
        RowBox[{"Part", "[", 
         RowBox[{"v", ",", " ", "3"}], "]"}]}], ",", " ", 
       RowBox[{"Part", "[", 
        RowBox[{"v", ",", " ", "2"}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Part", "[", 
        RowBox[{"v", ",", " ", "3"}], "]"}], ",", " ", "0", ",", " ", 
       RowBox[{"-", 
        RowBox[{"Part", "[", 
         RowBox[{"v", ",", " ", "1"}], "]"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Part", "[", 
         RowBox[{"v", ",", " ", "2"}], "]"}]}], ",", " ", 
       RowBox[{"Part", "[", 
        RowBox[{"v", ",", " ", "1"}], "]"}], ",", " ", "0"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"myMatrix", "[", 
     RowBox[{"n_Integer", ",", "m_Integer", ",", " ", "q_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{
         RowBox[{"H", "[", "q", "]"}], ",", "i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "m"}], "}"}]}], "]"}], "//", "MatrixForm"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phif", " ", "=", " ", 
   RowBox[{"\[Phi]", "[", "t", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tAt", " ", "=", " ", 
   RowBox[{"tA", "[", "t", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tEt", " ", "=", " ", 
    RowBox[{"tE", "[", "t", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DtAt", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"tAt", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DtEt", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"tEt", ",", "t"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"\[Xi]", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"phif", ",", "tAt", ",", "tEt"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Xi]", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"\[Xi]", ",", " ", "t"}], "]"}]}], ";", " ", 
  RowBox[{"d\[Xi]", " ", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dd\[Xi]", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"d\[Xi]", ",", "t"}], "]"}]}], ";", " ", 
  RowBox[{"dd\[Xi]", " ", "//", " ", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9448369780383453`*^9, 3.944836997951499*^9}, {
  3.944837042932482*^9, 3.94483720677221*^9}, {3.9449121126581163`*^9, 
  3.9449121589804096`*^9}, {3.9451218742787113`*^9, 3.9451218905424423`*^9}, {
  3.9451222867203608`*^9, 3.9451223137783804`*^9}, {3.9451287436074004`*^9, 
  3.9451287493111672`*^9}, {3.946429815488172*^9, 3.946429815695086*^9}},
 CellLabel->
  "In[468]:=",ExpressionUUID->"bc4828c5-aa88-461e-91d7-a1b197343224"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Phi]", "[", "t", "]"}], ",", 
   RowBox[{"tA", "[", "t", "]"}], ",", 
   RowBox[{"tE", "[", "t", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.944837116310091*^9, 3.9448371488267765`*^9}, {
   3.9448371808124723`*^9, 3.944837207463269*^9}, 3.944837322740863*^9, 
   3.944837481629478*^9, 3.9448375440493*^9, 3.9448382044781446`*^9, 
   3.944840068325187*^9, 3.944864591085883*^9, 3.9448646256655254`*^9, {
   3.944864697336335*^9, 3.944864723360613*^9}, 3.944912161465217*^9, 
   3.944912238965544*^9, 3.944912692099693*^9, 3.94491276207659*^9, 
   3.9449174570941315`*^9, 3.9449176034102345`*^9, 3.944918424268658*^9, {
   3.945117126137736*^9, 3.9451171510067315`*^9}, 3.945117812786703*^9, 
   3.9451178466856675`*^9, 3.945121354600233*^9, 3.9451215367268257`*^9, 
   3.9451217341410656`*^9, 3.945121773365883*^9, 3.9451218888710613`*^9, {
   3.9451219852261233`*^9, 3.9451220029487553`*^9}, 3.9451223101710715`*^9, 
   3.945122380368575*^9, 3.9451228115014906`*^9, 3.945126367907506*^9, 
   3.9451264219514537`*^9, {3.945126546935938*^9, 3.9451265738633547`*^9}, {
   3.9451281309829035`*^9, 3.945128159280324*^9}, 3.9451288549033766`*^9, 
   3.945129112344163*^9, 3.9451291630115275`*^9, 3.9451291991840143`*^9, 
   3.945129236376921*^9, 3.9464301284714746`*^9, 3.946430174959388*^9, 
   3.9464302240380716`*^9, 3.946468303359212*^9, 3.9464691060368524`*^9},
 CellLabel->
  "Out[480]=",ExpressionUUID->"ceffdd51-4c38-4b5c-89aa-45ef0dfefcda"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Rotations", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Rf", " ", "=", " ", 
     RowBox[{"Z", "[", "phif", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RAf", " ", "=", " ", 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"Pi", "/", "2"}], "]"}], ".", 
      RowBox[{"Z", "[", "tAt", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RCBf", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"RAf", ".", 
       RowBox[{"Z", "[", "aCB", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"REf", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"Pi", "/", "2"}], "]"}], ".", 
       RowBox[{"Z", "[", "tAt", "]"}], ".", 
       RowBox[{"Z", "[", "tEt", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RCAf", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"REf", ".", 
       RowBox[{"Z", "[", "aCA", "]"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.944837012015289*^9, 3.944837036162367*^9}, {
  3.9448372207472353`*^9, 3.9448373157270803`*^9}, {3.944838132369529*^9, 
  3.944838199968029*^9}, {3.9449173540242877`*^9, 3.944917448180705*^9}, {
  3.9449176012151017`*^9, 3.944917601343727*^9}, {3.9451287561236577`*^9, 
  3.9451287564439144`*^9}},
 CellLabel->
  "In[483]:=",ExpressionUUID->"c75b7502-d5a1-44f6-ad3f-86df156ff00e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Constants", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rAf", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"rAfx", ",", "0", ",", "rAfz"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rCBA", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"rCBAx", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rEA", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"rEAx", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rCAE", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"rCAEx", ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Hf", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Hfxx", ",", "Hfxy", ",", "Hfxz"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Hfxy", ",", "Hfyy", ",", "Hfyz"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Hfxz", ",", "Hfyz", ",", "Hfzz"}], "}"}]}], "}"}]}], ";"}], 
   " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HCB", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HCBxx", ",", "HCBxy", ",", "HCBxz"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"HCBxy", ",", "HCByy", ",", "HCByz"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"HCBxz", ",", "HCByz", ",", "HCBzz"}], "}"}]}], "}"}]}], 
    ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HCA", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"HCAxx", ",", "HCAxy", ",", "HCAxz"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"HCAxy", ",", "HCAyy", ",", "HCAyz"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"HCAxz", ",", "HCAyz", ",", "HCAzz"}], "}"}]}], "}"}]}], 
    ";"}], " "}]}]], "Input",
 CellChangeTimes->{{3.9448373426326227`*^9, 3.9448373843103256`*^9}, {
  3.944837427738944*^9, 3.9448374597412925`*^9}, {3.944837608092986*^9, 
  3.9448376362358932`*^9}, {3.9448380566493196`*^9, 3.944838112879465*^9}, {
  3.9449175623151116`*^9, 3.9449175702352304`*^9}, {3.9451168244611855`*^9, 
  3.9451168536222725`*^9}, {3.9451169149959717`*^9, 3.945117116110729*^9}, {
  3.945128764737602*^9, 3.9451287743803225`*^9}},
 CellLabel->
  "In[488]:=",ExpressionUUID->"8804a24c-49be-4b2a-bed0-cdb5607701de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Direct", " ", "kinematics"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rCBf", " ", "=", " ", 
     RowBox[{"rAf", " ", "+", " ", 
      RowBox[{"RCBf", ".", "rCBA"}]}]}], ";", 
    RowBox[{"rCBf", " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rCAf", " ", "=", " ", 
     RowBox[{"rAf", " ", "+", " ", 
      RowBox[{"RAf", ".", "rEA"}], " ", "+", " ", 
      RowBox[{"RCAf", ".", "rCAE"}]}]}], ";", " ", 
    RowBox[{"rCAf", " ", "//", " ", "MatrixForm"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.944837399108881*^9, 3.9448374238939667`*^9}, {
   3.9448375076191454`*^9, 3.9448376043812013`*^9}, {3.944837644302165*^9, 
   3.9448376536619616`*^9}, {3.9448379982880297`*^9, 3.944838045715829*^9}, {
   3.944864505230241*^9, 3.944864621753969*^9}, 3.9448646788433633`*^9, {
   3.944917587364179*^9, 3.944917589016262*^9}, 3.945117148339645*^9, {
   3.9464297647079372`*^9, 3.946429789839297*^9}},
 CellLabel->
  "In[495]:=",ExpressionUUID->"954f7162-b82d-4886-85c8-05ec92958784"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vCBf", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"rCBf", ",", "t"}], "]"}], "]"}]}], ";", " ", 
  RowBox[{"vCBf", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vCAf", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"D", "[", 
     RowBox[{"rCAf", ",", "t"}], "]"}], "]"}]}], ";", " ", 
  RowBox[{"vCAf", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.944837399108881*^9, 3.9448374238939667`*^9}, {
   3.9448375076191454`*^9, 3.9448376043812013`*^9}, {3.944837644302165*^9, 
   3.9448376536619616`*^9}, {3.9448379982880297`*^9, 3.944838045715829*^9}, {
   3.944864505230241*^9, 3.944864621753969*^9}, {3.9448646788433633`*^9, 
   3.9448647065069976`*^9}, 3.9451171438686876`*^9, {3.946429768120932*^9, 
   3.9464297768471675`*^9}},
 CellLabel->
  "In[497]:=",ExpressionUUID->"436db055-dacd-45e7-89ad-448818f3ef33"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"JvCB", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCBf", ",", "1"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "1"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "0"}]}], "}"}]}], " ", ",", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCBf", ",", "1"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "0"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "1"}]}], "}"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCBf", ",", "2"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "1"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "0"}]}], "}"}]}], " ", ",", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCBf", ",", "2"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "0"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "1"}]}], "}"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCBf", ",", "3"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "1"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "0"}]}], "}"}]}], " ", ",", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCBf", ",", "3"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "0"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "1"}]}], "}"}]}]}], "}"}]}], "}"}]}], 
  ";", 
  RowBox[{"JvCB", " ", "//", " ", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.94491181673026*^9, 3.944911829490878*^9}, {
  3.944911873811201*^9, 3.944911897786292*^9}, {3.9449119339733624`*^9, 
  3.944912090759446*^9}, {3.9449121324778605`*^9, 3.944912132588035*^9}, {
  3.944912170036841*^9, 3.944912221275359*^9}, {3.944912258201473*^9, 
  3.944912308394074*^9}, {3.9449124256192446`*^9, 3.944912575391715*^9}, {
  3.9451288182119217`*^9, 3.9451288282813683`*^9}, {3.9451288973728228`*^9, 
  3.945128909957716*^9}, {3.946429829179719*^9, 3.9464298507878127`*^9}},
 CellLabel->
  "In[499]:=",ExpressionUUID->"25040b2b-487a-4926-860b-778d6be3e0a2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "rCBAx"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"aCB", "+", 
         RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "0"},
     {"0", "0"},
     {
      RowBox[{"rCBAx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"aCB", "+", 
         RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.944912443172088*^9, 3.944912463535285*^9}, 
   3.9449125758018875`*^9, 3.944912693041746*^9, 3.944912762976779*^9, 
   3.94491745802757*^9, 3.9449176047420387`*^9, 3.944918425786641*^9, {
   3.945117127196922*^9, 3.945117151896493*^9}, 3.945117813203232*^9, 
   3.9451178470677633`*^9, 3.9451213549825773`*^9, 3.945121537258293*^9, 
   3.945121734607606*^9, 3.945121773731985*^9, {3.945121985684416*^9, 
   3.9451220034986*^9}, 3.9451223107464333`*^9, 3.9451223807849627`*^9, 
   3.9451228119651585`*^9, 3.9451263683481846`*^9, 3.9451264224344172`*^9, {
   3.945126547381072*^9, 3.9451265742792296`*^9}, {3.9451281313751183`*^9, 
   3.9451281596824865`*^9}, 3.945128869056224*^9, 3.945128913556107*^9, 
   3.945129112678996*^9, 3.945129163408699*^9, 3.9451291995009527`*^9, 
   3.9451292367863493`*^9, 3.946430175522152*^9, 3.9464302244212637`*^9, 
   3.946468303741373*^9, 3.946469106420972*^9},
 CellLabel->
  "Out[499]//MatrixForm=",ExpressionUUID->"c5a51427-8564-4291-a74e-\
a00a9c1fc451"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"JvCA", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCAf", ",", "1"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "1"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "0"}]}], "}"}]}], " ", ",", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCAf", ",", "1"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "0"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "1"}]}], "}"}]}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCAf", ",", "2"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "1"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "0"}]}], "}"}]}], " ", ",", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCAf", ",", "2"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "0"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "1"}]}], "}"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCAf", ",", "3"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "1"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "0"}]}], "}"}]}], " ", ",", 
       RowBox[{
        RowBox[{"Part", "[", 
         RowBox[{"vCAf", ",", "3"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"DtAt", "\[Rule]", "0"}], ",", 
          RowBox[{"DtEt", "\[Rule]", "1"}]}], "}"}]}]}], "}"}]}], "}"}]}], 
  ";", 
  RowBox[{"JvCA", "//", " ", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.9449126614267783`*^9, 3.9449126886834583`*^9}, {
  3.945128962639124*^9, 3.9451289737969766`*^9}, {3.9464298895563755`*^9, 
  3.9464299082412786`*^9}},
 CellLabel->
  "In[500]:=",ExpressionUUID->"8cc332b2-760a-47b4-9b4c-f108bc1fa262"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "rEAx"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"tA", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"rCAEx", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"aCA", "+", 
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"-", "rCAEx"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"aCA", "+", 
         RowBox[{"tA", "[", "t", "]"}], "+", 
         RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]},
     {"0", "0"},
     {
      RowBox[{
       RowBox[{"rEAx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"rCAEx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"aCA", "+", 
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"rCAEx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"aCA", "+", 
         RowBox[{"tA", "[", "t", "]"}], "+", 
         RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.9449126931581373`*^9, 3.944912763077018*^9, 3.9449174581526227`*^9, 
   3.9449176048675776`*^9, 3.9449184259195013`*^9, {3.945117127513926*^9, 
   3.9451171520219107`*^9}, 3.9451178133113785`*^9, 3.945117847159008*^9, 
   3.9451213550983458`*^9, 3.9451215373824387`*^9, 3.9451217347155895`*^9, 
   3.9451217738400793`*^9, {3.9451219857926636`*^9, 3.9451220035983686`*^9}, 
   3.945122310837773*^9, 3.945122380867441*^9, 3.9451228120478697`*^9, 
   3.9451263684394474`*^9, 3.945126422542222*^9, {3.945126547474842*^9, 
   3.9451265743735104`*^9}, {3.9451281314594035`*^9, 3.945128159761485*^9}, 
   3.945128977196682*^9, 3.945129112781047*^9, 3.9451291635276737`*^9, 
   3.9451291995837736`*^9, 3.945129236885954*^9, 3.946430175597726*^9, 
   3.9464302245213795`*^9, 3.9464683038329153`*^9, 3.946469106512555*^9},
 CellLabel->
  "Out[500]//MatrixForm=",ExpressionUUID->"69648650-3e16-4c49-99fd-\
feb1c9fb7981"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JwCB", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"JwCB", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JwCA", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"JwCA", "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9451171789033175`*^9, 3.94511724022674*^9}, {
   3.945128804638516*^9, 3.9451288063671074`*^9}, 3.9451288522531843`*^9, {
   3.9451289925237813`*^9, 3.945129003035636*^9}},
 CellLabel->
  "In[501]:=",ExpressionUUID->"40b43c8c-fb90-422c-a23d-061e9ff9e874"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"uz", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MvCB", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"skewMat", "[", 
      RowBox[{"Rf", ".", "rCBf"}], "]"}], ".", "uz"}]}]}], ";", " ", 
  RowBox[{"MvCB", " ", "//", " ", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MvCB", " ", "=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Part", "[", 
          RowBox[{"MvCB", " ", ",", "1"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Part", "[", 
          RowBox[{"MvCB", " ", ",", "2"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Part", "[", 
          RowBox[{"MvCB", " ", ",", "3"}], "]"}], "}"}]}], "}"}], ",", 
      RowBox[{"Rf", ".", "JvCB"}], ",", "2"}], "]"}]}], ";", " ", 
   RowBox[{"MvCB", " ", "//", " ", "MatrixForm"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MvCA", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"skewMat", "[", 
      RowBox[{"Rf", ".", "rCAf"}], "]"}], ".", "uz"}]}]}], ";", " ", 
  RowBox[{"MvCA", " ", "//", " ", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MvCA", " ", "=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Part", "[", 
          RowBox[{"MvCA", " ", ",", "1"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Part", "[", 
          RowBox[{"MvCA", " ", ",", "2"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Part", "[", 
          RowBox[{"MvCA", " ", ",", "3"}], "]"}], "}"}]}], "}"}], ",", 
      RowBox[{"Rf", ".", "JvCA"}], ",", "2"}], "]"}]}], ";", " ", 
   RowBox[{"MvCA", " ", "//", " ", "MatrixForm"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mwf", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", " ", 
   RowBox[{"Mwf", " ", "//", " ", "MatrixForm"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MwCB", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}], ",", 
     RowBox[{"Rf", ".", "JwCB"}], ",", "2"}], "]"}]}], ";", " ", 
  RowBox[{"MwCB", " ", "//", " ", "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MwCA", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}], ",", 
     RowBox[{"Rf", ".", "JwCA"}], ",", "2"}], "]"}]}], ";", " ", 
  RowBox[{
  "MwCA", "//", " ", "MatrixForm"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9451172519489737`*^9, 3.9451175178584824`*^9}, {
   3.9451175486447353`*^9, 3.9451175708019466`*^9}, {3.945117602977435*^9, 
   3.945117672508507*^9}, {3.9451177207559853`*^9, 3.945117723264864*^9}, {
   3.9451177899482164`*^9, 3.9451178102060905`*^9}, 3.9451178441865187`*^9, {
   3.9451211739391384`*^9, 3.945121351662219*^9}, {3.945129040116844*^9, 
   3.9451290440538263`*^9}, {3.945129150601644*^9, 3.9451291546861877`*^9}},
 CellLabel->
  "In[503]:=",ExpressionUUID->"a52b1b32-118b-4e38-91da-5e46a43a50d1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"rAfx", "+", 
          RowBox[{"rCBAx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"aCB", "+", 
             RowBox[{"tA", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "rCBAx"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"aCB", "+", 
         RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "0"},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rAfx", "+", 
         RowBox[{"rCBAx", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"aCB", "+", 
            RowBox[{"tA", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "rCBAx"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"aCB", "+", 
         RowBox[{"tA", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "0"},
     {"0", 
      RowBox[{"rCBAx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"aCB", "+", 
         RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.945117395715378*^9, 3.9451174590656867`*^9}, {
   3.945117492640938*^9, 3.945117518202724*^9}, {3.94511755223761*^9, 
   3.9451175711262703`*^9}, {3.9451176148167963`*^9, 3.9451176347116547`*^9}, 
   3.9451176728211145`*^9, 3.9451178136045675`*^9, 3.9451178474658155`*^9, {
   3.945121215681056*^9, 3.9451212283238087`*^9}, {3.945121271769077*^9, 
   3.945121308792761*^9}, {3.945121340965968*^9, 3.9451213553956795`*^9}, 
   3.9451215377887974`*^9, 3.9451217350475*^9, 3.9451217741471696`*^9, {
   3.945121986083885*^9, 3.9451220039221125`*^9}, 3.9451223110538034`*^9, 
   3.945122381083929*^9, 3.945122812287184*^9, 3.945126368688616*^9, 
   3.945126422817357*^9, {3.9451265477158737`*^9, 3.9451265746142583`*^9}, {
   3.94512813168419*^9, 3.945128159979123*^9}, {3.945129022243216*^9, 
   3.945129044547407*^9}, 3.945129112963941*^9, {3.9451291569188194`*^9, 
   3.945129163742518*^9}, 3.945129199718466*^9, 3.945129237030162*^9, 
   3.946430175706114*^9, 3.9464302246464276`*^9, 3.9464683039500675`*^9, 
   3.9464691066382437`*^9},
 CellLabel->
  "Out[505]//MatrixForm=",ExpressionUUID->"6fb663ce-23d8-45bf-b225-\
4d0d6580ee4b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"rAfx", "+", 
          RowBox[{"rEAx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"rCAEx", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"aCA", "+", 
             RowBox[{"tA", "[", "t", "]"}], "+", 
             RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "rEAx"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"tA", "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"rCAEx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"aCA", "+", 
            RowBox[{"tA", "[", "t", "]"}], "+", 
            RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "rCAEx"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"aCA", "+", 
         RowBox[{"tA", "[", "t", "]"}], "+", 
         RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rAfx", "+", 
         RowBox[{"rEAx", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"rCAEx", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"aCA", "+", 
            RowBox[{"tA", "[", "t", "]"}], "+", 
            RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "rEAx"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"tA", "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"rCAEx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"aCA", "+", 
            RowBox[{"tA", "[", "t", "]"}], "+", 
            RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", "rCAEx"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"aCA", "+", 
         RowBox[{"tA", "[", "t", "]"}], "+", 
         RowBox[{"tE", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]},
     {"0", 
      RowBox[{
       RowBox[{"rEAx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"rCAEx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"aCA", "+", 
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"rCAEx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"aCA", "+", 
         RowBox[{"tA", "[", "t", "]"}], "+", 
         RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.945117395715378*^9, 3.9451174590656867`*^9}, {
   3.945117492640938*^9, 3.945117518202724*^9}, {3.94511755223761*^9, 
   3.9451175711262703`*^9}, {3.9451176148167963`*^9, 3.9451176347116547`*^9}, 
   3.9451176728211145`*^9, 3.9451178136045675`*^9, 3.9451178474658155`*^9, {
   3.945121215681056*^9, 3.9451212283238087`*^9}, {3.945121271769077*^9, 
   3.945121308792761*^9}, {3.945121340965968*^9, 3.9451213553956795`*^9}, 
   3.9451215377887974`*^9, 3.9451217350475*^9, 3.9451217741471696`*^9, {
   3.945121986083885*^9, 3.9451220039221125`*^9}, 3.9451223110538034`*^9, 
   3.945122381083929*^9, 3.945122812287184*^9, 3.945126368688616*^9, 
   3.945126422817357*^9, {3.9451265477158737`*^9, 3.9451265746142583`*^9}, {
   3.94512813168419*^9, 3.945128159979123*^9}, {3.945129022243216*^9, 
   3.945129044547407*^9}, 3.945129112963941*^9, {3.9451291569188194`*^9, 
   3.945129163742518*^9}, 3.945129199718466*^9, 3.945129237030162*^9, 
   3.946430175706114*^9, 3.9464302246464276`*^9, 3.9464683039500675`*^9, 
   3.9464691066466427`*^9},
 CellLabel->
  "Out[507]//MatrixForm=",ExpressionUUID->"dd99f1c4-77c8-4bb6-8b96-\
f785c9ccd794"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "0"},
     {"1", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.945117395715378*^9, 3.9451174590656867`*^9}, {
   3.945117492640938*^9, 3.945117518202724*^9}, {3.94511755223761*^9, 
   3.9451175711262703`*^9}, {3.9451176148167963`*^9, 3.9451176347116547`*^9}, 
   3.9451176728211145`*^9, 3.9451178136045675`*^9, 3.9451178474658155`*^9, {
   3.945121215681056*^9, 3.9451212283238087`*^9}, {3.945121271769077*^9, 
   3.945121308792761*^9}, {3.945121340965968*^9, 3.9451213553956795`*^9}, 
   3.9451215377887974`*^9, 3.9451217350475*^9, 3.9451217741471696`*^9, {
   3.945121986083885*^9, 3.9451220039221125`*^9}, 3.9451223110538034`*^9, 
   3.945122381083929*^9, 3.945122812287184*^9, 3.945126368688616*^9, 
   3.945126422817357*^9, {3.9451265477158737`*^9, 3.9451265746142583`*^9}, {
   3.94512813168419*^9, 3.945128159979123*^9}, {3.945129022243216*^9, 
   3.945129044547407*^9}, 3.945129112963941*^9, {3.9451291569188194`*^9, 
   3.945129163742518*^9}, 3.945129199718466*^9, 3.945129237030162*^9, 
   3.946430175706114*^9, 3.9464302246464276`*^9, 3.9464683039500675`*^9, 
   3.946469106654688*^9},
 CellLabel->
  "Out[508]//MatrixForm=",ExpressionUUID->"f9fac580-7934-440d-a5a3-\
c24cff5d8bf4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], "0"},
     {"0", 
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], "0"},
     {"1", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.945117395715378*^9, 3.9451174590656867`*^9}, {
   3.945117492640938*^9, 3.945117518202724*^9}, {3.94511755223761*^9, 
   3.9451175711262703`*^9}, {3.9451176148167963`*^9, 3.9451176347116547`*^9}, 
   3.9451176728211145`*^9, 3.9451178136045675`*^9, 3.9451178474658155`*^9, {
   3.945121215681056*^9, 3.9451212283238087`*^9}, {3.945121271769077*^9, 
   3.945121308792761*^9}, {3.945121340965968*^9, 3.9451213553956795`*^9}, 
   3.9451215377887974`*^9, 3.9451217350475*^9, 3.9451217741471696`*^9, {
   3.945121986083885*^9, 3.9451220039221125`*^9}, 3.9451223110538034`*^9, 
   3.945122381083929*^9, 3.945122812287184*^9, 3.945126368688616*^9, 
   3.945126422817357*^9, {3.9451265477158737`*^9, 3.9451265746142583`*^9}, {
   3.94512813168419*^9, 3.945128159979123*^9}, {3.945129022243216*^9, 
   3.945129044547407*^9}, 3.945129112963941*^9, {3.9451291569188194`*^9, 
   3.945129163742518*^9}, 3.945129199718466*^9, 3.945129237030162*^9, 
   3.946430175706114*^9, 3.9464302246464276`*^9, 3.9464683039500675`*^9, 
   3.946469106663077*^9},
 CellLabel->
  "Out[509]//MatrixForm=",ExpressionUUID->"bed70fe6-3196-48e3-94bd-\
e64e15423ea7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]},
     {"0", 
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}], 
      RowBox[{"-", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "[", "t", "]"}], "]"}]}]},
     {"1", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.945117395715378*^9, 3.9451174590656867`*^9}, {
   3.945117492640938*^9, 3.945117518202724*^9}, {3.94511755223761*^9, 
   3.9451175711262703`*^9}, {3.9451176148167963`*^9, 3.9451176347116547`*^9}, 
   3.9451176728211145`*^9, 3.9451178136045675`*^9, 3.9451178474658155`*^9, {
   3.945121215681056*^9, 3.9451212283238087`*^9}, {3.945121271769077*^9, 
   3.945121308792761*^9}, {3.945121340965968*^9, 3.9451213553956795`*^9}, 
   3.9451215377887974`*^9, 3.9451217350475*^9, 3.9451217741471696`*^9, {
   3.945121986083885*^9, 3.9451220039221125`*^9}, 3.9451223110538034`*^9, 
   3.945122381083929*^9, 3.945122812287184*^9, 3.945126368688616*^9, 
   3.945126422817357*^9, {3.9451265477158737`*^9, 3.9451265746142583`*^9}, {
   3.94512813168419*^9, 3.945128159979123*^9}, {3.945129022243216*^9, 
   3.945129044547407*^9}, 3.945129112963941*^9, {3.9451291569188194`*^9, 
   3.945129163742518*^9}, 3.945129199718466*^9, 3.945129237030162*^9, 
   3.946430175706114*^9, 3.9464302246464276`*^9, 3.9464683039500675`*^9, 
   3.9464691066715937`*^9},
 CellLabel->
  "Out[510]//MatrixForm=",ExpressionUUID->"8ee0a3a9-38b4-4145-97c0-\
927c2728469b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HCBf", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"RAf", ".", "HCB", ".", 
     RowBox[{"Transpose", "[", "RAf", "]"}]}], "]"}]}], ";", " ", 
  RowBox[{"HCBf", " ", "//", " ", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HCAf", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"REf", ".", "HCA", ".", 
     RowBox[{"Transpose", "[", "REf", "]"}]}], "]"}]}], ";", " ", 
  RowBox[{"HCAf", " ", "//", " ", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.945121409215912*^9, 3.9451215335319633`*^9}, {
  3.9451290781677217`*^9, 3.945129078574941*^9}},
 CellLabel->
  "In[511]:=",ExpressionUUID->"e073251f-fb16-4138-8168-07f0d6ef0d91"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"M", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "Mwf", "]"}], ".", "Hf", ".", "Mwf"}], " ", 
     "+", " ", 
     RowBox[{"mCB", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", "MvCB", "]"}], ".", "MvCB"}]}], " ", "+", 
     " ", 
     RowBox[{"mCA", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", "MvCA", "]"}], ".", "MvCA"}]}]}]}], " ", 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", " ", "=", " ", 
   RowBox[{"M", " ", "+", " ", 
    RowBox[{
     RowBox[{"Transpose", "[", "MwCB", "]"}], ".", "Rf", ".", "HCBf", ".", 
     RowBox[{"Transpose", "[", "Rf", "]"}], ".", "MwCB"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"Transpose", "[", "MwCA", "]"}], ".", "Rf", ".", "HCAf", ".", 
     RowBox[{"Transpose", "[", "Rf", "]"}], ".", "MwCA"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", " ", "=", " ", 
   RowBox[{"Simplify", "[", "M", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"M", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.945121543354295*^9, 3.945121752058445*^9}, {
  3.9451290882417307`*^9, 3.945129095725055*^9}},
 CellLabel->
  "In[513]:=",ExpressionUUID->"ea961488-a6df-4b99-b86b-080d0f69b02b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Hfzz", "+", 
       RowBox[{"HCByy", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{"tA", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{"mCB", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"rAfx", "+", 
           RowBox[{"rCBAx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"aCB", "+", 
              RowBox[{"tA", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{"HCAyy", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"tA", "[", "t", "]"}], "+", 
           RowBox[{"tE", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"mCA", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"rAfx", "+", 
           RowBox[{"rEAx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"rCAEx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"aCA", "+", 
              RowBox[{"tA", "[", "t", "]"}], "+", 
              RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{"HCBxx", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{"tA", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{"HCBxy", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"HCAxx", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"tA", "[", "t", "]"}], "+", 
           RowBox[{"tE", "[", "t", "]"}]}], "]"}], "2"]}], "+", 
       RowBox[{"HCAxy", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"tA", "[", "t", "]"}], "+", 
            RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"HCByz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"HCAyz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"HCBxz", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"HCAxz", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"HCAyz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"HCAxz", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"HCByz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"HCAyz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"HCBxz", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"HCAxz", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"HCAzz", "+", "HCBzz", "+", 
       RowBox[{"mCA", " ", 
        SuperscriptBox["rCAEx", "2"]}], "+", 
       RowBox[{"mCB", " ", 
        SuperscriptBox["rCBAx", "2"]}], "+", 
       RowBox[{"mCA", " ", 
        SuperscriptBox["rEAx", "2"]}], "+", 
       RowBox[{"2", " ", "mCA", " ", "rCAEx", " ", "rEAx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"aCA", "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"HCAzz", "+", 
       RowBox[{"mCA", " ", 
        SuperscriptBox["rCAEx", "2"]}], "+", 
       RowBox[{"mCA", " ", "rCAEx", " ", "rEAx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"aCA", "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"HCAyz", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"HCAxz", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"HCAzz", "+", 
       RowBox[{"mCA", " ", 
        SuperscriptBox["rCAEx", "2"]}], "+", 
       RowBox[{"mCA", " ", "rCAEx", " ", "rEAx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"aCA", "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"HCAzz", "+", 
       RowBox[{"mCA", " ", 
        SuperscriptBox["rCAEx", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.945121605688486*^9, 3.9451216408646955`*^9}, {
   3.945121735728571*^9, 3.9451217744469767`*^9}, {3.9451219864883437`*^9, 
   3.945122004314328*^9}, 3.945122311270472*^9, 3.9451223813008676`*^9, 
   3.9451228125276313`*^9, 3.9451263689325027`*^9, 3.945126423128248*^9, {
   3.945126547952364*^9, 3.945126574858333*^9}, {3.945128131905128*^9, 
   3.945128160219307*^9}, {3.945129113838004*^9, 3.9451291643712225`*^9}, 
   3.9451292000620065`*^9, 3.9451292374989047`*^9, 3.946430176107689*^9, 
   3.9464302249544497`*^9, 3.9464683044999914`*^9, 3.946469106796729*^9},
 CellLabel->
  "Out[516]//MatrixForm=",ExpressionUUID->"c69da0f9-0532-47a9-99b6-\
a0c79a8f5885"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CorFunc", "[", " ", 
    RowBox[{"k_", ",", " ", "j_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"term1", ",", " ", "term2", ",", " ", "term3"}], "}"}], ",", 
     " ", "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t", 
     RowBox[{
      RowBox[{"Ckj", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      "\t\t\t\t\t\t\t\t\t", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "\[LessEqual]", " ", "3"}], ",", 
        RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
        "\t\t\t\t\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"term1", " ", "=", "  ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "j"}], "]"}], "]"}], ",", " ", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t", 
         RowBox[{"term2", " ", "=", "  ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "i"}], "]"}], "]"}], ",", " ", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t\t", 
         RowBox[{"term3", " ", "=", "  ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"M", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", " ", 
            RowBox[{"\[Xi]", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t", 
         RowBox[{"Ckj", "=", 
          RowBox[{"Ckj", " ", "+", "  ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", 
            RowBox[{"(", " ", 
             RowBox[{
             "term1", " ", "+", " ", "term2", " ", "-", " ", "term3"}], ")"}], 
            RowBox[{"d\[Xi]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t\t", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\t\t\t\t\t\t\t\t", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coriolis", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", " ", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "k", "]"}], ";", " ", 
  RowBox[{"Clear", "[", "j", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"k", "=", "1"}], ",", " ", 
   RowBox[{"k", "\[LessEqual]", " ", "3"}], ",", " ", 
   RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", "\t", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
     RowBox[{"j", "\[LessEqual]", "  ", "3"}], ",", " ", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"Clear", "[", "Ckj", "]"}], ";", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"CorFunc", "[", 
       RowBox[{"k", ",", " ", "j"}], "]"}], ";", "\[IndentingNewLine]", 
      "\t\t", 
      RowBox[{
       RowBox[{"Coriolis", "[", 
        RowBox[{"[", 
         RowBox[{"k", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", "Ckj"}], 
      ";"}]}], "\[IndentingNewLine]", "\t", "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coriolis", " ", "=", " ", 
   RowBox[{"Simplify", "[", "Coriolis", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Coriolis", " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9451219401215696`*^9, 3.9451220006101236`*^9}, {
  3.9451265365918603`*^9, 3.945126544885515*^9}, {3.945129175468299*^9, 
  3.9451291895254807`*^9}},
 CellLabel->
  "In[517]:=",ExpressionUUID->"d9511d7e-cd1d-4792-99e3-3b7260cd25ba"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "HCBxy", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "+", 
            RowBox[{"2", " ", "HCAxy", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"tA", "[", "t", "]"}], "+", 
                 RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
            RowBox[{"HCBxx", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "-", 
            RowBox[{"HCByy", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "-", 
            RowBox[{"2", " ", "mCB", " ", "rCBAx", " ", 
             RowBox[{"(", 
              RowBox[{"rAfx", "+", 
               RowBox[{"rCBAx", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"aCB", "+", 
                  RowBox[{"tA", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"aCB", "+", 
               RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "+", 
            RowBox[{"HCAxx", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"tA", "[", "t", "]"}], "+", 
                 RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "-", 
            RowBox[{"HCAyy", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"tA", "[", "t", "]"}], "+", 
                 RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "-", 
            RowBox[{"2", " ", "mCA", " ", 
             RowBox[{"(", 
              RowBox[{"rAfx", "+", 
               RowBox[{"rEAx", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
               RowBox[{"rCAEx", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"aCA", "+", 
                  RowBox[{"tA", "[", "t", "]"}], "+", 
                  RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rEAx", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
               RowBox[{"rCAEx", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"aCA", "+", 
                  RowBox[{"tA", "[", "t", "]"}], "+", 
                  RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], 
           ")"}], " ", 
          RowBox[{
           SuperscriptBox["tA", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "HCAxy", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"tA", "[", "t", "]"}], "+", 
                 RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"HCAxx", "-", "HCAyy"}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"tA", "[", "t", "]"}], "+", 
                 RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "-", 
            RowBox[{"2", " ", "mCA", " ", "rCAEx", " ", 
             RowBox[{"(", 
              RowBox[{"rAfx", "+", 
               RowBox[{"rEAx", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
               RowBox[{"rCAEx", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"aCA", "+", 
                  RowBox[{"tA", "[", "t", "]"}], "+", 
                  RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"aCA", "+", 
               RowBox[{"tA", "[", "t", "]"}], "+", 
               RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["tE", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"HCBxz", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"HCAxz", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"tA", "[", "t", "]"}], "+", 
             RowBox[{"tE", "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"HCByz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"tA", "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"HCAyz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"tA", "[", "t", "]"}], "+", 
             RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["tA", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"HCAxz", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"tA", "[", "t", "]"}], "+", 
             RowBox[{"tE", "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"HCAyz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"tA", "[", "t", "]"}], "+", 
             RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["tE", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "HCBxy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"2", " ", "HCAxy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"tA", "[", "t", "]"}], "+", 
               RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{"HCBxx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"HCByy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"2", " ", "mCB", " ", "rCBAx", " ", 
           RowBox[{"(", 
            RowBox[{"rAfx", "+", 
             RowBox[{"rCBAx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"aCB", "+", 
                RowBox[{"tA", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"aCB", "+", 
             RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"HCAxx", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"tA", "[", "t", "]"}], "+", 
               RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"HCAyy", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"tA", "[", "t", "]"}], "+", 
               RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"2", " ", "mCA", " ", 
           RowBox[{"(", 
            RowBox[{"rAfx", "+", 
             RowBox[{"rEAx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"rCAEx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"aCA", "+", 
                RowBox[{"tA", "[", "t", "]"}], "+", 
                RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rEAx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"rCAEx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"aCA", "+", 
                RowBox[{"tA", "[", "t", "]"}], "+", 
                RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}], 
        " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"HCAxz", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"tA", "[", "t", "]"}], "+", 
             RowBox[{"tE", "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"HCAyz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"tA", "[", "t", "]"}], "+", 
             RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["tA", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"HCAxz", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"tA", "[", "t", "]"}], "+", 
             RowBox[{"tE", "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"HCAyz", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"tA", "[", "t", "]"}], "+", 
             RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["tE", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "HCAxy", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"tA", "[", "t", "]"}], "+", 
               RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"HCAxx", "-", "HCAyy"}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"tA", "[", "t", "]"}], "+", 
               RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "-", 
          RowBox[{"2", " ", "mCA", " ", "rCAEx", " ", 
           RowBox[{"(", 
            RowBox[{"rAfx", "+", 
             RowBox[{"rEAx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"rCAEx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"aCA", "+", 
                RowBox[{"tA", "[", "t", "]"}], "+", 
                RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"aCA", "+", 
             RowBox[{"tA", "[", "t", "]"}], "+", 
             RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "HCBxy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"2", " ", "HCAxy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tA", "[", "t", "]"}], "+", 
              RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "-", 
         RowBox[{"HCBxx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"HCByy", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", "mCB", " ", "rCBAx", " ", 
          RowBox[{"(", 
           RowBox[{"rAfx", "+", 
            RowBox[{"rCBAx", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"aCB", "+", 
               RowBox[{"tA", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"aCB", "+", 
            RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"HCAxx", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tA", "[", "t", "]"}], "+", 
              RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
         RowBox[{"HCAyy", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tA", "[", "t", "]"}], "+", 
              RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", "mCA", " ", 
          RowBox[{"(", 
           RowBox[{"rAfx", "+", 
            RowBox[{"rEAx", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"rCAEx", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"aCA", "+", 
               RowBox[{"tA", "[", "t", "]"}], "+", 
               RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rEAx", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"rCAEx", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"aCA", "+", 
               RowBox[{"tA", "[", "t", "]"}], "+", 
               RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}], 
       " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"-", "mCA"}], " ", "rCAEx", " ", "rEAx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"aCA", "+", 
         RowBox[{"tE", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["tE", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"-", "mCA"}], " ", "rCAEx", " ", "rEAx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"aCA", "+", 
         RowBox[{"tE", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["tA", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["tE", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "HCAxy", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tA", "[", "t", "]"}], "+", 
              RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "HCAxx"}], "+", "HCAyy"}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"tA", "[", "t", "]"}], "+", 
              RowBox[{"tE", "[", "t", "]"}]}], ")"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", "mCA", " ", "rCAEx", " ", 
          RowBox[{"(", 
           RowBox[{"rAfx", "+", 
            RowBox[{"rEAx", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"rCAEx", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"aCA", "+", 
               RowBox[{"tA", "[", "t", "]"}], "+", 
               RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"aCA", "+", 
            RowBox[{"tA", "[", "t", "]"}], "+", 
            RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Phi]", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"mCA", " ", "rCAEx", " ", "rEAx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"aCA", "+", 
         RowBox[{"tE", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["tA", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.945121986688366*^9, 3.9451220045727186`*^9}, 
   3.945122311577318*^9, 3.945122381563378*^9, 3.945122812859194*^9, 
   3.9451263692642355`*^9, 3.945126423395525*^9, {3.945126568274212*^9, 
   3.9451265808813696`*^9}, {3.9451281452200503`*^9, 3.945128160428505*^9}, 
   3.9451291334090376`*^9, {3.945129195261091*^9, 3.945129205424528*^9}, 
   3.9451292386317987`*^9, 3.9464301851283665`*^9, 3.9464302251046844`*^9, 
   3.9464683141409397`*^9, 3.946469106946867*^9},
 CellLabel->
  "Out[522]//MatrixForm=",ExpressionUUID->"19c8eb9f-49ee-4fd5-8af6-\
084e89f38207"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rCB", " ", "=", " ", 
   RowBox[{"Rf", ".", "rCBf"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rCA", " ", "=", " ", 
   RowBox[{"Rf", ".", "rCAf"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UP", " ", "=", " ", 
   RowBox[{
    RowBox[{"mCB", " ", "g", " ", 
     RowBox[{"uz", ".", "rCB"}]}], " ", "+", " ", 
    RowBox[{"mCA", " ", "g", " ", 
     RowBox[{"uz", ".", "rCA"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UP", " ", "=", " ", 
   RowBox[{"Simplify", "[", "UP", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gv", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"UP", ",", 
     RowBox[{"{", "\[Xi]", "}"}]}], "]"}]}], ";", " ", 
  RowBox[{"Gv", " ", "//", " ", "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{{3.9451220859012156`*^9, 3.9451222174908657`*^9}, {
   3.9451292118129406`*^9, 3.9451292184277287`*^9}, 3.9464300599705887`*^9},
 CellLabel->
  "In[523]:=",ExpressionUUID->"48c6ea21-db64-4e77-a9bb-38f36c370a42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", " ", "mCB", " ", 
   RowBox[{"(", 
    RowBox[{"rAfz", "+", 
     RowBox[{"rCBAx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"aCB", "+", 
        RowBox[{"tA", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"g", " ", "mCA", " ", 
   RowBox[{"(", 
    RowBox[{"rAfz", "+", 
     RowBox[{"rEAx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
     RowBox[{"rCAEx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"aCA", "+", 
        RowBox[{"tA", "[", "t", "]"}], "+", 
        RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9451222006431913`*^9, 3.9451222180269403`*^9}, 
   3.9451223116935806`*^9, 3.94512238179661*^9, 3.9451228130006533`*^9, 
   3.9451263694220123`*^9, 3.945126423562669*^9, 3.9451265810919604`*^9, {
   3.9451281453855143`*^9, 3.9451281606022835`*^9}, 3.945129133643886*^9, 
   3.9451292056935525`*^9, 3.9451292389345646`*^9, 3.946430185345724*^9, 
   3.946430225321046*^9, 3.946468314357476*^9, 3.946469107038498*^9},
 CellLabel->
  "Out[526]=",ExpressionUUID->"4dcd6972-2032-42fc-b68e-dbba656b8827"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{
        RowBox[{"g", " ", "mCB", " ", "rCBAx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"aCB", "+", 
           RowBox[{"tA", "[", "t", "]"}]}], "]"}]}], "+", 
        RowBox[{"g", " ", "mCA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"rEAx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"tA", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"rCAEx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"aCA", "+", 
              RowBox[{"tA", "[", "t", "]"}], "+", 
              RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}]},
      {
       RowBox[{"g", " ", "mCA", " ", "rCAEx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"aCA", "+", 
          RowBox[{"tA", "[", "t", "]"}], "+", 
          RowBox[{"tE", "[", "t", "]"}]}], "]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9451222006431913`*^9, 3.9451222180269403`*^9}, 
   3.9451223116935806`*^9, 3.94512238179661*^9, 3.9451228130006533`*^9, 
   3.9451263694220123`*^9, 3.945126423562669*^9, 3.9451265810919604`*^9, {
   3.9451281453855143`*^9, 3.9451281606022835`*^9}, 3.945129133643886*^9, 
   3.9451292056935525`*^9, 3.9451292389345646`*^9, 3.946430185345724*^9, 
   3.946430225321046*^9, 3.946468314357476*^9, 3.946469107054984*^9},
 CellLabel->
  "Out[527]//MatrixForm=",ExpressionUUID->"4fac2392-77f0-4174-a14f-\
d0332129d0bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dr", " ", "=", " ", 
  RowBox[{"NotebookDirectory", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"drc", " ", "=", " ", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
   "dr", ",", " ", 
    "\"\<\\\\Mathematica Expressions\\\\AssumeNoBucket_Model.m\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{"drc", ",", " ", "n"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeleteFile", "[", "drc", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "M", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "Coriolis", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "Gv", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "\[Xi]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Save", "[", 
  RowBox[{"drc", ",", " ", 
   RowBox[{"{", 
    RowBox[{"M", ",", " ", "Coriolis", ",", "Gv", ",", "\[Xi]"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.946430141936*^9, 3.946430163815727*^9}, {
  3.9464302204767995`*^9, 3.946430221465407*^9}, {3.946468287773733*^9, 
  3.9464682880143924`*^9}},
 CellLabel->
  "In[528]:=",ExpressionUUID->"dc6e58f3-f3fb-4969-ad76-26064134ac7a"],

Cell[BoxData["\<\"C:\\\\Users\\\\Dell\\\\Documents\\\\DEX\\\\\"\>"], "Output",
 CellChangeTimes->{3.9464301854962993`*^9, 3.9464302254369335`*^9, 
  3.946468314473874*^9, 3.94646910737964*^9},
 CellLabel->
  "Out[528]=",ExpressionUUID->"a2cac2c0-1234-4b2d-ab14-e82e0639762e"],

Cell[BoxData["\<\"C:\\\\Users\\\\Dell\\\\Documents\\\\DEX\\\\\\\\Mathematica \
Expressions\\\\AssumeNoBucket_Model.m\"\>"], "Output",
 CellChangeTimes->{3.9464301854962993`*^9, 3.9464302254369335`*^9, 
  3.946468314473874*^9, 3.9464691073881454`*^9},
 CellLabel->
  "Out[529]=",ExpressionUUID->"27376a73-1bb8-4bc1-9b63-d599b5fca668"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.9464301854962993`*^9, 3.9464302254369335`*^9, 
  3.946468314473874*^9, 3.9464691073965225`*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"4e96fb44-3aab-4cc6-8e49-529f9a80ebd2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.9464301854962993`*^9, 3.9464302254369335`*^9, 
  3.946468314473874*^9, 3.9464691073965225`*^9},
 CellLabel->
  "Out[533]=",ExpressionUUID->"9b808403-7ed4-497e-a720-7dd8dbaa7b27"],

Cell[BoxData[
 RowBox[{"{", "3", "}"}]], "Output",
 CellChangeTimes->{3.9464301854962993`*^9, 3.9464302254369335`*^9, 
  3.946468314473874*^9, 3.946469107404575*^9},
 CellLabel->
  "Out[534]=",ExpressionUUID->"bd91814d-d14b-405f-bed9-f80263af96c1"],

Cell[BoxData[
 RowBox[{"{", "3", "}"}]], "Output",
 CellChangeTimes->{3.9464301854962993`*^9, 3.9464302254369335`*^9, 
  3.946468314473874*^9, 3.946469107412992*^9},
 CellLabel->
  "Out[535]=",ExpressionUUID->"1e7cb925-7f56-405b-9cad-55312953a003"]
}, Open  ]]
},
WindowSize->{958, 981},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"beac8792-fdc4-45db-8dcf-ca03265ec5b0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4800, 139, 390, "Input",ExpressionUUID->"bc4828c5-aa88-461e-91d7-a1b197343224"],
Cell[5383, 163, 1503, 24, 32, "Output",ExpressionUUID->"ceffdd51-4c38-4b5c-89aa-45ef0dfefcda"]
}, Open  ]],
Cell[6901, 190, 1494, 39, 124, "Input",ExpressionUUID->"c75b7502-d5a1-44f6-ad3f-86df156ff00e"],
Cell[8398, 231, 2420, 64, 181, "Input",ExpressionUUID->"8804a24c-49be-4b2a-bed0-cdb5607701de"],
Cell[10821, 297, 1143, 25, 86, "Input",ExpressionUUID->"954f7162-b82d-4886-85c8-05ec92958784"],
Cell[11967, 324, 940, 20, 48, "Input",ExpressionUUID->"436db055-dacd-45e7-89ad-448818f3ef33"],
Cell[CellGroupData[{
Cell[12932, 348, 2394, 63, 86, "Input",ExpressionUUID->"25040b2b-487a-4926-860b-778d6be3e0a2"],
Cell[15329, 413, 1804, 41, 79, "Output",ExpressionUUID->"c5a51427-8564-4291-a74e-a00a9c1fc451"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17170, 459, 2052, 59, 86, "Input",ExpressionUUID->"8cc332b2-760a-47b4-9b4c-f108bc1fa262"],
Cell[19225, 520, 2466, 61, 79, "Output",ExpressionUUID->"69648650-3e16-4c49-99fd-feb1c9fb7981"]
}, Open  ]],
Cell[21706, 584, 1064, 31, 67, "Input",ExpressionUUID->"40b43c8c-fb90-422c-a23d-061e9ff9e874"],
Cell[CellGroupData[{
Cell[22795, 619, 3727, 102, 238, "Input",ExpressionUUID->"a52b1b32-118b-4e38-91da-5e46a43a50d1"],
Cell[26525, 723, 2923, 71, 79, "Output",ExpressionUUID->"6fb663ce-23d8-45bf-b225-4d0d6580ee4b"],
Cell[29451, 796, 4689, 119, 79, "Output",ExpressionUUID->"dd99f1c4-77c8-4bb6-8b96-f785c9ccd794"],
Cell[34143, 917, 1667, 34, 79, "Output",ExpressionUUID->"f9fac580-7934-440d-a5a3-c24cff5d8bf4"],
Cell[35813, 953, 1835, 39, 79, "Output",ExpressionUUID->"bed70fe6-3196-48e3-94bd-e64e15423ea7"],
Cell[37651, 994, 2005, 44, 65, "Output",ExpressionUUID->"8ee0a3a9-38b4-4145-97c0-927c2728469b"]
}, Open  ]],
Cell[39671, 1041, 748, 18, 67, "Input",ExpressionUUID->"e073251f-fb16-4138-8168-07f0d6ef0d91"],
Cell[CellGroupData[{
Cell[40444, 1063, 1256, 33, 86, "Input",ExpressionUUID->"ea961488-a6df-4b99-b86b-080d0f69b02b"],
Cell[41703, 1098, 6094, 163, 85, "Output",ExpressionUUID->"c69da0f9-0532-47a9-99b6-a0c79a8f5885"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47834, 1266, 3951, 97, 390, "Input",ExpressionUUID->"d9511d7e-cd1d-4792-99e3-3b7260cd25ba"],
Cell[51788, 1365, 17882, 461, 106, "Output",ExpressionUUID->"19c8eb9f-49ee-4fd5-8af6-084e89f38207"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69707, 1831, 1048, 27, 143, "Input",ExpressionUUID->"48c6ea21-db64-4e77-a9bb-38f36c370a42"],
Cell[70758, 1860, 1154, 27, 32, "Output",ExpressionUUID->"4dcd6972-2032-42fc-b68e-dbba656b8827"],
Cell[71915, 1889, 1887, 48, 79, "Output",ExpressionUUID->"4fac2392-77f0-4174-a14f-d0332129d0bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73839, 1942, 1229, 29, 219, "Input",ExpressionUUID->"dc6e58f3-f3fb-4969-ad76-26064134ac7a"],
Cell[75071, 1973, 275, 4, 32, "Output",ExpressionUUID->"a2cac2c0-1234-4b2d-ab14-e82e0639762e"],
Cell[75349, 1979, 333, 5, 32, "Output",ExpressionUUID->"27376a73-1bb8-4bc1-9b63-d599b5fca668"],
Cell[75685, 1986, 273, 6, 32, "Output",ExpressionUUID->"4e96fb44-3aab-4cc6-8e49-529f9a80ebd2"],
Cell[75961, 1994, 273, 6, 32, "Output",ExpressionUUID->"9b808403-7ed4-497e-a720-7dd8dbaa7b27"],
Cell[76237, 2002, 248, 5, 32, "Output",ExpressionUUID->"bd91814d-d14b-405f-bed9-f80263af96c1"],
Cell[76488, 2009, 248, 5, 79, "Output",ExpressionUUID->"1e7cb925-7f56-405b-9cad-55312953a003"]
}, Open  ]]
}
]
*)

